<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playbook de Resposta a Incidentes - Comprometimento de Contas</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --dark-blue: #000529;
            --identity-blue: #0055aa;
            /* Cores Baseadas no Fluxograma e NIST */
            --color-preparacao: #2E8500;   /* Verde */
            --color-deteccao: #d35400;     /* Laranja/Marrom */
            --color-contencao: #c62828;    /* Vermelho Intenso */
            --color-erradicacao: #b71c1c;  /* Vermelho Escuro */
            --color-recuperacao: #b71c1c;  /* Roxo/Magenta */
            --color-pos-incidente: #0277bd;/* Azul */
            --gray-panel: #0a0a3d;
            --text-light: #f4f4f4;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            background-color: var(--dark-blue);
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* Layout */
        .viewport { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; scroll-behavior: smooth; }
        .header-title { text-align: center; margin-bottom: 30px; }
        .header-title h1 { margin: 0; font-size: 28px; letter-spacing: 2px; color: #fff; }
        .header-title p { margin: 5px 0; opacity: 0.8; font-weight: 300; }

        /* Cards de Conteúdo */
        .content-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 40px;
            width: 90%;
            max-width: 1100px;
            color: #222;
            display: none; 
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8);
            margin-bottom: 60px;
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .active { display: block; }

        .img-container { 
            width: 100%; 
            text-align: center; 
            margin-bottom: 25px; 
            background: #f8f9fa; 
            border-radius: 8px; 
            padding: 15px 0;
            border: 1px dashed #ccc;
        }
        .img-container img { max-width: 100%; height: auto; border-radius: 4px; }

        /* Botões de Ação dentro do Card */
        .btn-container { text-align: center; margin-top: 20px; }
        .btn-details { 
            display: inline-block; 
            margin: 10px 5px; 
            padding: 14px 35px; 
            background-color: #1a1a1a; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: 700; 
            text-transform: uppercase;
            transition: 0.3s;
        }
        .btn-details:hover { background-color: #444; transform: scale(1.02); }
        .btn-back { background-color: #7f8c8d; }

        /* Seções de Informação Expandida */
        .extra-info { display: none; margin-top: 30px; border-top: 2px solid #eee; padding-top: 30px; }
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .info-section h3 { border-left: 5px solid var(--identity-blue); padding-left: 15px; color: #1a1a1a; margin-bottom: 15px; font-size: 18px; }
        .info-section p, .info-section li { line-height: 1.6; color: #444; font-size: 15px; }
        .tool-tag { 
            display: inline-block; 
            background: #e1f5fe; 
            color: #0277bd; 
            padding: 4px 10px; 
            border-radius: 4px; 
            font-size: 13px; 
            font-weight: bold; 
            margin: 4px;
            border: 1px solid #b3e5fc;
        }

        /* Barra de Navegação */
        .nav-bar { background-color: var(--gray-panel); display: flex; padding: 15px; gap: 8px; justify-content: center; flex-wrap: wrap; box-shadow: 0 -5px 20px rgba(0,0,0,0.5); }
        .nav-btn { 
            flex: 1; 
            min-width: 150px; 
            padding: 15px 10px; 
            font-weight: 900; 
            cursor: pointer; 
            text-align: center; 
            font-size: 11px; 
            border: none; 
            color: rgb(255, 255, 255); 
            border-radius: 4px; 
            transition: 0.2s;
            text-transform: uppercase;
        }
        .nav-btn:hover { filter: brightness(1.3); transform: translateY(-2px); }

        /* Cores dos Botões */
        .c-preparacao { background-color: var(--color-preparacao); }
        .c-deteccao { background-color: var(--color-deteccao); }
        .c-contencao { background-color: var(--color-contencao); }
        .c-erradicacao { background-color: var(--color-erradicacao); }
        .c-recuperacao { background-color: var(--color-recuperacao); }
        .c-pos { background-color: var(--color-pos-incidente); }

        @media (max-width: 768px) {
            .info-grid { grid-template-columns: 1fr; }
            .nav-btn { min-width: 45%; }
        }
    </style>
</head>
<body>

    <div class="viewport">
        <div class="header-title">
            <h1>CICLO BASEADO EM NIST SP 800-61</h1>
            <p>Para um cenário de Comprometimento de Contas (Account Takeover), a aplicação prática das fases da NIST SP 800-61r3 foca em conter o acesso e restaurar a identidade.
</p>
        </div>

        <div id="principal" class="content-card active">
            <h2 style="text-align: center; color: #333;">FLUXOGRAMA DE DECISÃO</h2>
            <div class="img-container">
                <img src="images/fluxo_principal_contas.jpg" alt="Fluxograma Completo">
            </div>
            <p style="text-align: center; color: #666;">Selecione uma fase abaixo na barra de navegação para ver ações detalhadas e ferramentas.</p>
        </div>

        <div id="fase1" class="content-card">
            <h2 style="color: var(--color-preparacao)">1. PREPARAÇÃO</h2>
            <div class="img-container"><img src="images/fluxo_fase1_contas.jpg"></div>
            <div class="info-grid">
                <div class="info-section">
                    <h3>Ações Técnicas de Mitigação</h3>
                    <ul>
                        <li><strong>MFA Mandatório:</strong> Implementar autenticação multi-fator em todos os serviços expostos (SaaS, VPN, SSH).</li>
                        <li><strong>Hardening de Identidade:</strong> Desabilitar protocolos legados (POP3, IMAP, SMTP Auth) que ignoram MFA.</li>
                        <li><strong>Monitoramento de Login:</strong> Configurar alertas para "Impossible Travel" e novos países de acesso.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h3>Ferramentas Recomendadas</h3>
                    <span class="tool-tag">Microsoft Entra ID</span> <span class="tool-tag">Okta</span>
                    <span class="tool-tag">CyberArk PAM</span> <span class="tool-tag">Duo Security</span>
                    <span class="tool-tag">Bitwarden</span>
                </div>
            </div>
            <div class="btn-container">
                <button class="btn-details btn-back" onclick="showPhase('principal')">VOLTAR AO INÍCIO</button>
            </div>
        </div>

        <div id="fase2" class="content-card">
            <h2 style="color: var(--color-deteccao)">2. DETECÇÃO E ANÁLISE</h2>
            <div class="img-container"><img src="images/fluxo_fase2_contas.jpg"></div>
            <div class="info-grid">
                <div class="info-section">
                    <h3>Investigação de Vetores</h3>
                    <ul>
                        <li><strong>Análise de IP:</strong> Checar se o IP de origem pertence a uma VPN comercial, Proxy de saída ou rede TOR.</li>
                        <li><strong>User-Agent:</strong> Identificar se o navegador utilizado foge ao padrão do colaborador (ex: Python-requests).</li>
                        <li><strong>Logs de Auditoria:</strong> Buscar por falhas de login consecutivas (Brute Force) seguidas de um sucesso.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h3>Ferramentas Recomendadas</h3>
                    <span class="tool-tag">Splunk</span> <span class="tool-tag">Elastic SIEM</span>
                    <span class="tool-tag">VirusTotal</span> <span class="tool-tag">GreyNoise</span>
                    <span class="tool-tag">Microsoft Sentinel</span>
                </div>
            </div>
            <div class="btn-container">
                <button class="btn-details btn-back" onclick="showPhase('principal')">VOLTAR</button>
            </div>
        </div>

        <div id="fase3" class="content-card">
            <h2 style="color: var(--color-contencao)">3. CONTENÇÃO</h2>
            <div class="img-container"><img src="images/fluxo_fase3_contas.jpg"></div>
            <div class="info-grid">
                <div class="info-section">
                    <h3>Interrupção do Ataque</h3>
                    <ul>
                        <li><strong>Revogação de Sessão:</strong> Forçar o logout de todas as sessões ativas (Revoke Refresh Tokens).</li>
                        <li><strong>Bloqueio Temporário:</strong> Desativar a conta no diretório ativo (AD/Azure AD) imediatamente.</li>
                        <li><strong>Isolamento de Host:</strong> Se o login partiu de um host interno, isolar a máquina da rede via EDR.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h3>Ferramentas Recomendadas</h3>
                    <span class="tool-tag">Palo Alto XSOAR</span> <span class="tool-tag">CrowdStrike</span>
                    <span class="tool-tag">SentinelOne</span> <span class="tool-tag">Tines (Automation)</span>
                </div>
            </div>
            <div class="btn-container">
                <button class="btn-details btn-back" onclick="showPhase('principal')">VOLTAR</button>
            </div>
        </div>

        <div id="fase4" class="content-card">
            <h2 style="color: var(--color-erradicacao)">4. ERRADICAÇÃO</h2>
            <div class="img-container"><img src="images/fluxo_fase4_contas.jpg"></div>
            <div class="info-grid">
                <div class="info-section">
                    <h3>Limpeza de Persistência</h3>
                    <ul>
                        <li><strong>Regras de E-mail:</strong> Remover regras de "Mover para Itens Excluídos" criadas pelo atacante para ocultar rastro.</li>
                        <li><strong>OAuth Apps:</strong> Auditar e remover aplicativos de terceiros autorizados durante a sessão comprometida.</li>
                        <li><strong>MFA Bypass:</strong> Verificar se o atacante cadastrou um novo dispositivo MFA (ex: Token de hardware dele).</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h3>Ferramentas Recomendadas</h3>
                    <span class="tool-tag">PowerShell (Exchange Module)</span>
                    <span class="tool-tag">Microsoft Defender for Cloud Apps</span>
                    <span class="tool-tag">Wiz.io</span>
                </div>
            </div>
            <div class="btn-container">
                <button class="btn-details btn-back" onclick="showPhase('principal')">VOLTAR</button>
            </div>
        </div>

        <div id="fase5" class="content-card">
            <h2 style="color: var(--color-recuperacao)">5. RECUPERAÇÃO</h2>
            <div class="img-container"><img src="images/fluxo_fase5_contas.jpg"></div>
            <div class="info-grid">
                <div class="info-section">
                    <h3>Retorno à Operação</h3>
                    <ul>
                        <li><strong>Reset de Credencial:</strong> Alterar a senha seguindo políticas de complexidade (mínimo 14 caracteres).</li>
                        <li><strong>Novo Enrolment MFA:</strong> Exigir que o usuário recadastre o MFA através de um processo de "ID Proofing".</li>
                        <li><strong>Auditoria de Sistemas:</strong> Restaurar backups de dados se houver evidência de alteração ou deleção.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h3>Ferramentas Recomendadas</h3>
                    <span class="tool-tag">Veeam Backup</span> <span class="tool-tag">Azure SSPR</span>
                    <span class="tool-tag">Qualys Vulnerability Management</span>
                </div>
            </div>
            <div class="btn-container">
                <button class="btn-details btn-back" onclick="showPhase('principal')">VOLTAR</button>
            </div>
        </div>

        <div id="fase6" class="content-card">
            <h2 style="color: var(--color-pos-incidente)">6. ATIVIDADES PÓS-INCIDENTE</h2>
            <div class="img-container"><img src="images/fluxo_fase6_contas.jpg"></div>
            <div class="info-grid">
                <div class="info-section">
                    <h3>Melhoria Estratégica</h3>
                    <ul>
                        <li><strong>Lessons Learned:</strong> Reunião com as partes interessadas para identificar falhas no processo.</li>
                        <li><strong>Relatório Final:</strong> Documentar a causa raiz, tempo de resposta (MTTR) e impacto financeiro.</li>
                        <li><strong>Treinamento:</strong> Se o vetor foi Phishing, aplicar treinamento direcionado ao usuário afetado.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <h3>Ferramentas Recomendadas</h3>
                    <span class="tool-tag">Jira Service Management</span>
                    <span class="tool-tag">KnowBe4 Awareness</span>
                    <span class="tool-tag">Confluence Wiki</span>
                </div>
            </div>
            <div class="btn-container">
                <button class="btn-details btn-back" onclick="showPhase('principal')">VOLTAR</button>
            </div>
        </div>
    </div>

    <div class="nav-bar">
        <button class="nav-btn c-preparacao" onclick="showPhase('fase1')">1. Preparação</button>
        <button class="nav-btn c-deteccao" onclick="showPhase('fase2')">2. Detecção</button>
        <button class="nav-btn c-contencao" onclick="showPhase('fase3')">3. Contenção</button>
        <button class="nav-btn c-erradicacao" onclick="showPhase('fase4')">4. Erradicação</button>
        <button class="nav-btn c-recuperacao" onclick="showPhase('fase5')">5. Recuperação</button>
        <button class="nav-btn c-pos" onclick="showPhase('fase6')">6. Pós-Incidente</button>
    </div>

    <script>
        function showPhase(id) {
            // Esconde todos os cards
            document.querySelectorAll('.content-card').forEach(card => {
                card.classList.remove('active');
            });
            // Mostra o card selecionado
            const target = document.getElementById(id);
            if(target) {
                target.classList.add('active');
            }
            // Scroll para o topo do card
            document.querySelector('.viewport').scrollTop = 0;
        }
    </script>
</body>
</html>